---
import CommonHead from "@/components/common-head.astro";
import CommonBody from "@/components/common-body.astro";
import StructuredData from "@/components/structured-data.astro";
import SidePage from "@/components/side-page";
import Navbar from "@/components/navbar";
import "@/styles/global.css";

import { initI18n, extractNavbarTranslations } from "@/i18n";
import { getResumeData } from "@/data/get-resume-data";

const { language, t } = initI18n(Astro);

const pageTitle = language === "ko" 
  ? "사이드 프로젝트" 
  : "Side Projects";
const pageDescription = language === "ko"
  ? "개발하면서 필요했던 기능들을 범용적인 오픈소스 라이브러리로 만들어 공개했습니다."
  : "I've created and published general-purpose open-source libraries for functionality I needed during development.";
const navbarTranslations = extractNavbarTranslations(t);
const resumeData = getResumeData(t);

// SEO Keywords for AI crawlers
const keywords = language === 'ko' 
  ? "사이드 프로젝트, 오픈소스, 개발자 포트폴리오, 프론트엔드 개발자 이력서, 풀스택 개발자 이력서, 프론트엔드 개발자, 풀스택 개발자, 라이브러리, NPM, TypeScript, JavaScript, 무궁화, 가우스 나선, 엣지 크립토, 이하민, Hamin Lee, 개발자 도구"
  : "Side Projects, Open Source, developer portfolio, frontend developer resume, full stack developer resume, frontend developer, full stack developer, library, NPM, TypeScript, JavaScript, Mugunghwa, Gauss Spiral, Edge Crypto, Hamin Lee, developer tools";

const sideTranslations = {
  hero: t.sideProjects?.hero || {
    title: language === "ko" ? "사이드 프로젝트" : "Side Projects",
    subtitle: language === "ko" ? "오픈소스 라이브러리 컬렉션" : "Open Source Library Collection",
    description: language === "ko" 
      ? "개발하면서 필요했던 기능들을 범용적인 오픈소스 라이브러리로 만들어 공개했습니다. 각 프로젝트는 실제 문제를 해결하기 위해 설계되었으며, TypeScript로 작성되어 타입 안정성을 보장합니다."
      : "I've created and published general-purpose open-source libraries for functionality I needed during development. Each project is designed to solve real problems and is written in TypeScript to ensure type safety.",
    websiteLink: language === "ko" ? "웹사이트" : "Website",
    backToResume: language === "ko" ? "이력서로 돌아가기" : "Back to Resume",
  },
  projects: t.sideProjects?.projects || {},
};
const ogImage = new URL(`/en/side-og.png`, Astro.url).toString();

// Check if nonav query parameter is present
const hideNavbar = Astro.url.searchParams.has('nonav');
---

<html lang={language}>
  <head>
    <CommonHead 
      title={pageTitle} 
      description={pageDescription} 
      lang={language} 
      ogImage={ogImage}
      keywords={keywords}
      author="Hamin Lee"
    />
    <StructuredData lang={language} data={resumeData} pageType="side" />
    <script is:inline>
      // Force light theme for side page
      (function () {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("theme", "light");
      })();
    </script>
  </head>
  <body>
    <CommonBody lang={language} />
    <SidePage client:idle lang={language} translations={sideTranslations} />
    {!hideNavbar && <Navbar client:idle lang={language} translations={navbarTranslations} />}
  </body>
</html>
